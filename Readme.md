# Cache开发说明

#### 当前进度

当前目录下为半成品的ICache，有一个未完成的非常低级的DCache。

ICache的输入输出接口均为半成品，能够支持完成一定的功能，但是不能够进行完整的接口配置。其内部功能已经初步仿真正确，可综合验证。

现在DCache的开发面临困局，首先是结构和状态机不能够与流水线进行对接，同时整个流水线的结构显得扑朔迷离，不仅如此，当前的代码和数据通路的构造显得不够清晰和合理，状态机的设计也存在着相当的不合理性。

现在的脏逻辑是比较不全的，功能缺失，关于将bank的各部分的写使能分开，不要一起写，这个等整个的功能一步一步开发之后再进行重构和关键路径的优化。还有就是假如是两级的流水线，那么如果读和（脏数据）写冲突了，那么就应该是写优先。写数据会比读数据慢一拍，这样的话就刚好碰在一起，就不用读RAM了，只执行写操作，对于读操作直接拿写的数据就好了（好有道理，这不就解决了写相关）。

现在的下一个目标：~~实现脏标志的正确赋值~~，脏数据的正确弹出（读不命中），脏数据写入内存。现在暂时还不考虑切流水，首先是功能第一，其次是现在双发射那边还没有做出来，不知道到时候到底是什么一个工序。

要想实现脏数据的正确弹出，以及脏数据的写入内存，就必须先写出一个Buffer出来，那么接下来这两天的target就是写出个WriteBuffer出来。 

现在感觉脏逻辑里头，有一些不应该使用时序逻辑的东西，看看是不是有点问题，用组合逻辑比较好。

写在最后：Cache的裸开发真的非常费神，真的是个打击哎。😔

#### 紧接着要做的事情

- FIFO的重复写和重复读问题
- 单纯的FIFO的实现

#### 剩余待实现的功能

- DCache
- 写回型store的实现
- 写入缓冲FIFO
- 总线块打包（完整的cache）
- 流水切割（初具成果的cache）
- Cache指令
- 硬件初始化（决赛的基本要求）
- 指令预取
- 双发射（最终成品的cache的基础版）
- 这之后就是各种提升性能的关键所在了